---
- hosts: all
  vars:
    PROJECT_HOME: "/vagrant"
  tasks:
    - name: upgrade OS packages
      sudo: yes
      apt: update-cache=yes upgrade=yes
    - name: install OS packages
      sudo: yes
      apt: pkg={{ item }} state=present
      with_items:
       - python-virtualenv
       - git-core
       - python2.7
       - python-pip
    - name: create virtualenv
      shell: virtualenv -p /usr/bin/python2 "{{ PROJECT_HOME }}/venv"
             creates="{{ PROJECT_HOME }}/venv/bin/activate"
    - name: install Python packages
      pip: virtualenv="{{ PROJECT_HOME }}/venv"
           requirements={{ PROJECT_HOME }}/requirements.txt
      tags: debug
